(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{49:function(e,t,a){e.exports=a(91)},54:function(e,t,a){},55:function(e,t,a){},83:function(e,t){},84:function(e,t){},85:function(e,t){},86:function(e,t){},87:function(e,t){},88:function(e,t){},91:function(e,t,a){"use strict";a.r(t);var n=a(1),r=a.n(n),i=a(19),s=a.n(i),l=(a(54),a(7)),c=a(8),o=a(10),u=a(9),m=a(11),d=(a(55),a(12)),h=a.n(d),p=a(104),f=a(15),b="https://us-central1-ecohouse-9136c.cloudfunctions.net/getLastWeatherEntry",v="https://us-central1-ecohouse-9136c.cloudfunctions.net/getLastHouseDataEntry",E="https://us-central1-ecohouse-9136c.cloudfunctions.net/getAllHouseDataEntries",O="https://us-central1-ecohouse-9136c.cloudfunctions.net/getAllWeatherEntries",y=function(e){function t(e){var a;return Object(l.a)(this,t),(a=Object(o.a)(this,Object(u.a)(t).call(this,e))).state={currentCity:"-",currentTemp:0,currentHumidity:0},a}return Object(m.a)(t,e),Object(c.a)(t,[{key:"componentDidMount",value:function(){var e=this;h.a.get("https://api.openweathermap.org/data/2.5/weather?id=3093133&appid=3c786bff59e49394d1d9b34220351622&units=metric").then(function(t){var a=t.data;console.log("tempData",a),e.setState(function(e){return{currentCity:a.name,currentTemp:a.main.temp,currentHumidity:a.main.humidity,currentPressure:a.main.pressure}})})}},{key:"render",value:function(){var e=this.props.classes;return r.a.createElement(p.a,{className:e.infoPaper},r.a.createElement("h4",null," Weather forecast for : ",this.state.currentCity," "),r.a.createElement("h4",null," Current temperature : ",this.state.currentTemp," "),r.a.createElement("h4",null," Current pressure  : ",this.state.currentPressure," hPa "),r.a.createElement("h4",null," Humidity in ",this.state.currentCity," : ",this.state.currentHumidity," %"))}}]),t}(r.a.Component),j=Object(f.a)(function(e){return{infoPaper:{textAlign:"center",margin:20,width:"100%"}}})(y),g=function(e){function t(){var e,a;Object(l.a)(this,t);for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return(a=Object(o.a)(this,(e=Object(u.a)(t)).call.apply(e,[this].concat(r)))).state={time:new Date},a}return Object(m.a)(t,e),Object(c.a)(t,[{key:"componentDidMount",value:function(){var e=this;this.timerID=setInterval(function(){return e.tick()},1e3)}},{key:"componentWillUnmount",value:function(){clearInterval(this.timerID)}},{key:"tick",value:function(){this.setState({time:new Date})}},{key:"render",value:function(){return r.a.createElement("div",null,r.a.createElement("h1",null,"Have a nice day!"),r.a.createElement("h2",null,"It is ",this.state.time.toLocaleTimeString()))}}]),t}(r.a.Component),k=a(32),w=a.n(k),M=a(44),C=a(29),D=a(16),T=a(105),x=a(106),S=100,H=D.b(),L={units:4,inputShape:[3],activation:"sigmoid"},W={units:1,activation:"sigmoid"},I={optimizer:D.d.sgd(.1),loss:"meanSquaredError"},R={verbose:!0,epochs:5},P=(D.c([[22,23,29]]),D.c([[22,23,25],[22,23,25],[21,23,28],[15,23,23],[16,23,24],[17,23,25],[23,23,28],[23,23,28],[23,23,28],[24,23,31],[23,23,25],[26,23,28],[12,23,17],[11,23,25],[19,23,28],[15,23,22],[13,23,19],[15,23,28],[23,23,19],[23,23,15],[23,23,18],[23,23,11],[23,23,10],[23,23,8]])),N=D.c([[1],[1],[1],[1],[1],[1],[0],[0],[0],[0],[0],[0],[1],[1],[1],[1],[1],[1],[0],[0],[0],[0],[0],[0]]),A=function(e){function t(e){var a;return Object(l.a)(this,t),(a=Object(o.a)(this,Object(u.a)(t).call(this,e))).onChange=function(e){a.setState(Object(C.a)({},e.target.id,e.target.value))},a.startML=function(){var e=[parseInt(a.state.lastHomedataResult.temp),parseInt(a.state.desiredTemp),parseInt(a.state.lastWeatherResult.temp)],t=D.c([e]);H.predict(t).data().then(function(e){console.log("res",e),a.setState({result:Math.round(e)})})},a.startMLOnRealData=function(){h.a.all([h.a.get(b,{crossdomain:!0}),h.a.get(v,{crossdomain:!0})]).then(h.a.spread(function(e,t){a.setState({lastWeatherResult:{datetime:e.data[0][0].datetime.value,temp:e.data[0][0].temp,humidity:e.data[0][0].humidity,pressure:e.data[0][0].pressure},lastHomedataResult:{datetime:t.data[0][0].datetime.value,temp:t.data[0][0].temp_house,pressure:t.data[0][0].pressure_house}})})).then(function(){a.startML()})},a.trainModel=Object(M.a)(w.a.mark(function e(){var t,a;return w.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:t=0;case 1:if(!(t<S)){e.next=10;break}return e.next=4,H.fit(P,N,R);case 4:a=e.sent,t===S-1&&this.setState({finalLoss:a.history.loss[0]}),console.log(a.history.loss[0]);case 7:t++,e.next=1;break;case 10:case"end":return e.stop()}},e,this)})),a.state={isModelTrained:!1,result:null,currentTemp:0,desiredTemp:23,outsiteTemp:0,finalLoss:0,lastWeatherResult:{},lastHomedataResult:{}},a}return Object(m.a)(t,e),Object(c.a)(t,[{key:"componentWillMount",value:function(){var e=this,t=D.a.dense(L),a=D.a.dense(W);H.add(t),H.add(a),H.compile(I),this.trainModel().then(function(){console.log("training completed"),e.setState({isModelTrained:!0})})}},{key:"createResult",value:function(e){return 1===e?"OPEN WINDOWS TO HEAT HOUSE":0===e?"CLOSE WINDOWS TO REDUCE COLLING OF HOUSE":"-"}},{key:"render",value:function(){var e,t=this.state,a=t.result,n=t.finalLoss,i=t.lastWeatherResult,s=t.lastHomedataResult;return r.a.createElement("div",null,r.a.createElement(T.a,{container:!0,direction:"column"},r.a.createElement(T.a,{item:!0,xs:6},r.a.createElement("h4",null,"Machine Learning Component")),r.a.createElement(T.a,{item:!0,xs:6},r.a.createElement("p",null,"Weather forecast for ",i.datetime," "),r.a.createElement("table",null,r.a.createElement("tr",null,"Temp: ",i.temp),r.a.createElement("tr",null,"Humidity: ",i.humidity),r.a.createElement("tr",null,"Pressure: ",i.pressure)),r.a.createElement("p",null,"House data for ",s.datetime," "),r.a.createElement("table",null,r.a.createElement("tr",null,"Temp: ",s.temp),r.a.createElement("tr",null,"Pressure: ",s.pressure)),r.a.createElement(x.a,{variant:"contained",onClick:this.startMLOnRealData,disabled:!this.state.isModelTrained},"Do ML!")),r.a.createElement(T.a,(e={item:!0},Object(C.a)(e,"item",!0),Object(C.a)(e,"xs",6),e),r.a.createElement("div",null,"Final Loss of the Model is: ",n),r.a.createElement("div",null,"Result is: ",this.createResult(a)))),r.a.createElement("div",{style:{position:"fixed",width:"100%",height:"100%",display:this.state.isModelTrained?"none":"block",top:0,left:0,zIndex:1e3,background:"rgba(255,255,255,0.8)"}},r.a.createElement("p",{style:{position:"fixed",display:this.state.isModelTrained?"none":"block",top:"50%",left:"50%",zIndex:1e3}}," ","System is learning now :) ",r.a.createElement("br",null)," Please give it a moment or two.")))}}]),t}(r.a.Component),z=a(47),U=a.n(z),F=function(e){function t(e){var a;return Object(l.a)(this,t),(a=Object(o.a)(this,Object(u.a)(t).call(this,e))).state={},a}return Object(m.a)(t,e),Object(c.a)(t,[{key:"componentDidMount",value:function(){var e={},t={};h.a.all([h.a.get(O),h.a.get(E)]).then(h.a.spread(function(a,n){a.data[0].forEach(function(e){t[e.datetime.value]=e.temp}),n.data[0].forEach(function(t){e[t.datetime.value]=t.temp_house})})).then(function(){new U.a("historicalDataChart",{type:"scatter",data:{labels:Object.keys(e),datasets:[{label:"Temp House",fill:!1,data:Object.values(e),backgroundColor:"red",borderColor:"red"},{label:"Temp Weather",fill:!1,data:Object.values(t),backgroundColor:"blue",borderColor:"blue"}]},options:{scales:{xAxes:[{type:"time",distribution:"linear",time:{round:"minute",unit:"hour",stepSize:"2",displayFormats:{day:"MMM D",hour:"MMM D h:mm a"}},scaleLabel:{display:!0,labelString:"Date"}}]}}})})}},{key:"render",value:function(){this.props.classes;return r.a.createElement("div",null,r.a.createElement("canvas",{id:"historicalDataChart",width:"300",height:"150"}))}}]),t}(r.a.Component),_=Object(f.a)(function(e){return{}})(F),B=function(e){function t(){return Object(l.a)(this,t),Object(o.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(m.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){var e=this.props.classes;return r.a.createElement(T.a,{container:!0,className:e.container,justify:"flex-end",spacing:5},r.a.createElement(T.a,{item:!0,xs:7},r.a.createElement(_,null),r.a.createElement(A,null)),r.a.createElement(T.a,{item:!0,xs:5},r.a.createElement(T.a,{container:!0,direction:"column",justify:"flex-end",spacing:5},r.a.createElement(g,null),r.a.createElement(j,null))))}}]),t}(r.a.Component),J=Object(f.a)(function(e){return{container:{}}})(B),q=function(e){function t(){return Object(l.a)(this,t),Object(o.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(m.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){var e=this.props.classes;return r.a.createElement("div",{className:e.root},r.a.createElement(J,null," "))}}]),t}(r.a.Component),G=Object(f.a)(function(e){return{root:{padding:24}}})(q);Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));s.a.render(r.a.createElement(G,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then(function(e){e.unregister()})}},[[49,1,2]]]);
//# sourceMappingURL=main.9d14e145.chunk.js.map